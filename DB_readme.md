# LePain Dashboard 데이터베이스 구조

이 문서는 LePain Dashboard 프로젝트의 Supabase 데이터베이스 구조를 설명합니다.

## 개요

Supabase 프로젝트: `DashBoard` (byqtooupqqorrovwxezs)
데이터베이스 URL: `https://byqtooupqqorrovwxezs.supabase.co`

## 테이블 구조

데이터베이스는 크게 다음과 같은 테이블로 구성되어 있습니다:

1. **receipt_sales_detail**: 영수증 단위의 상세 판매 데이터
2. **daily_sales_summary**: 일일 판매 요약 데이터

### 1. receipt_sales_detail

영수증 단위의 상세 판매 데이터를 저장하는 테이블입니다. 각 상품의 판매 정보가 기록됩니다.

| 컬럼명 | 데이터 타입 | 설명 | 예시 값 |
|--------|------------|------|---------|
| id | integer | 고유 식별자 (PK) | 1 |
| date | date | 판매 일자 | 2025-01-01 |
| pos_number | text | POS 번호 | 1 |
| receipt_number | text | 영수증 번호 | 1 |
| payment_type | text | 결제 유형 | 매출 |
| table_name | text | 테이블 이름 | NaN |
| first_order | timestamp | 첫 주문 시간 | 2025-01-01T09:39:31 |
| payment_time | timestamp | 결제 시간 | 2025-01-01T09:39:32 |
| product_code | text | 상품 코드 | 900511 |
| barcode | text | 바코드 | NaN |
| product_name | text | 상품명 | 우유식빵 |
| quantity | integer | 수량 | 1 |
| total_sales | integer | 총 판매액 | 6300 |
| erp_mapping_code | text | ERP 매핑 코드 | NaN |
| note | text | 비고 | NaN |
| discount_amount | integer | 할인 금액 | 0 |
| discount_type | text | 할인 유형 | null |
| actual_sales | integer | 실제 판매액 (할인 적용 후) | 6300 |
| price | integer | 판매 가격 (부가세 제외) | 5728 |
| vat | integer | 부가세 | 572 |
| created_at | timestamp | 레코드 생성 시간 | 2025-05-12T07:26:59.759103 |
| store_name | text | 매장명 | 석촌점 |

### 2. daily_sales_summary

일별 매장의 판매 요약 정보를 저장하는 테이블입니다. 영수증 단위의 요약 정보가 기록됩니다.

| 컬럼명 | 데이터 타입 | 설명 | 예시 값 |
|--------|------------|------|---------|
| id | integer | 고유 식별자 (PK) | 1 |
| date | date | 판매 일자 | 2025-01-01 |
| no | integer | 일련번호 | 1 |
| pos_number | text | POS 번호 | 1 |
| receipt_number | text | 영수증 번호 | 86 |
| payment_time | timestamp | 결제 시간 | 2025-01-01T17:53:59 |
| payment_type | text | 결제 유형 | 매출 |
| total_sales | integer | 총 판매액 | 32500 |
| total_discount | integer | 총 할인액 | 0 |
| actual_sales | integer | 실제 판매액 (할인 적용 후) | 32500 |
| price | integer | 판매 가격 (부가세 제외) | 29547 |
| vat | integer | 부가세 | 2953 |
| created_at | timestamp | 레코드 생성 시간 | 2025-05-12T07:26:33.303861 |
| store_name | text | 매장명 | 몽핀점 |

## 데이터 관계

두 테이블 간의 관계는 다음과 같습니다:

- `receipt_sales_detail`은 각 상품별 판매 데이터를 저장합니다.
- `daily_sales_summary`는 영수증 단위의 판매 요약 데이터를 저장합니다.
- 두 테이블은 `date`, `pos_number`, `receipt_number`, `store_name` 컬럼을 통해 연결될 수 있습니다.

## 사용 예시

### 일별 매출 조회

```sql
SELECT 
  date, 
  SUM(actual_sales) as total_revenue 
FROM daily_sales_summary 
GROUP BY date 
ORDER BY date;
```

### 상품별 판매량 조회

```sql
SELECT 
  product_name, 
  SUM(quantity) as total_quantity, 
  SUM(actual_sales) as total_sales 
FROM receipt_sales_detail 
GROUP BY product_name 
ORDER BY total_sales DESC;
```

### 매장별 매출 비교

```sql
SELECT 
  store_name, 
  SUM(actual_sales) as total_revenue 
FROM daily_sales_summary 
GROUP BY store_name 
ORDER BY total_revenue DESC;
```

## 데이터 주의사항

1. `NaN` 문자열은 NULL 값이 아닌 실제 문자열 "NaN"으로 저장되어 있습니다.
2. 날짜 관련 필드는 UTC 시간으로 저장되어 있을 수 있습니다.
3. 금액 관련 필드는 KRW(원) 단위로 저장되어 있습니다.

## 샘플 데이터

### 1. receipt_sales_detail 테이블 샘플 데이터

아래는 receipt_sales_detail 테이블의 실제 샘플 데이터 20개입니다:

| id | date | store_name | receipt_number | payment_time | product_name | quantity | total_sales | discount_amount | actual_sales |
|----|------|------------|----------------|--------------|--------------|----------|-------------|-----------------|--------------|
| 1 | 2025-01-01 | 석촌점 | 1 | 2025-01-01T09:39:32 | 우유식빵 | 1 | 6300 | 0 | 6300 |
| 2 | 2025-01-01 | 석촌점 | 2 | 2025-01-01T10:03:46 | 통딸기생크림 1호 현장 | 1 | 59000 | 0 | 59000 |
| 3 | 2025-01-01 | 석촌점 | 3 | 2025-01-01T10:04:37 | 보냉팩 | 2 | 1000 | 0 | 1000 |
| 4 | 2025-01-01 | 석촌점 | 4 | 2025-01-01T10:10:57 | 통딸기생크림 1호 현장 | 1 | 59000 | 0 | 59000 |
| 5 | 2025-01-01 | 석촌점 | 4 | 2025-01-01T10:10:57 | 통밀100%식빵 | 1 | 8400 | 0 | 8400 |
| 6 | 2025-01-01 | 석촌점 | 4 | 2025-01-01T10:10:57 | 콰트로치즈브레드 | 1 | 6700 | 0 | 6700 |
| 7 | 2025-01-01 | 석촌점 | 4 | 2025-01-01T10:10:57 | 크림단팥빵 | 1 | 3800 | 0 | 3800 |
| 8 | 2025-01-01 | 석촌점 | 4 | 2025-01-01T10:10:57 | 단팥빵 | 2 | 6800 | 0 | 6800 |
| 9 | 2025-01-01 | 석촌점 | 4 | 2025-01-01T10:10:57 | 티슈브레드 | 2 | 15000 | 0 | 15000 |
| 10 | 2025-01-01 | 석촌점 | 4 | 2025-01-01T10:10:57 | 종이 쇼핑백 | 1 | 300 | 0 | 300 |
| 11 | 2025-01-01 | 석촌점 | 5 | 2025-01-01T10:15:56 | 콰트로치즈브레드 | 1 | 6700 | 0 | 6700 |
| 12 | 2025-01-01 | 석촌점 | 5 | 2025-01-01T10:15:56 | 명란바게트 | 1 | 5800 | 0 | 5800 |
| 13 | 2025-01-01 | 석촌점 | 5 | 2025-01-01T10:15:56 | 누룽지빵 | 1 | 5600 | 0 | 5600 |
| 14 | 2025-01-01 | 석촌점 | 5 | 2025-01-01T10:15:56 | 찹쌀마블레 | 1 | 4800 | 0 | 4800 |
| 15 | 2025-01-01 | 석촌점 | 5 | 2025-01-01T10:15:56 | 봉투 | 1 | 50 | 0 | 50 |
| 16 | 2025-01-01 | 석촌점 | 6 | 2025-01-01T10:18:23 | 찹쌀마블레 | 1 | 4800 | 0 | 4800 |
| 17 | 2025-01-01 | 석촌점 | 6 | 2025-01-01T10:18:23 | 크랜베리식빵 | 1 | 6600 | 0 | 6600 |
| 18 | 2025-01-01 | 석촌점 | 6 | 2025-01-01T10:18:23 | 티슈브레드 | 1 | 7500 | 0 | 7500 |
| 19 | 2025-01-01 | 석촌점 | 6 | 2025-01-01T10:18:23 | 소금빵 | 1 | 4000 | 0 | 4000 |
| 20 | 2025-01-01 | 석촌점 | 6 | 2025-01-01T10:18:23 | 종이봉투 | 1 | 100 | 0 | 100 |

> 참고: 이 테이블은 각 판매 상품의 상세 정보를 포함하고 있습니다. 하나의 영수증(receipt_number)에 여러 상품이 포함될 수 있습니다.

### 2. daily_sales_summary 테이블 샘플 데이터

아래는 daily_sales_summary 테이블의 실제 샘플 데이터 20개입니다:

| id | date | store_name | receipt_number | payment_time | total_sales | total_discount | actual_sales | price | vat |
|----|------|------------|----------------|--------------|-------------|----------------|--------------|-------|-----|
| 1 | 2025-01-01 | 몽핀점 | 86 | 2025-01-01T17:53:59 | 32500 | 0 | 32500 | 29547 | 2953 |
| 2 | 2025-01-01 | 몽핀점 | 85 | 2025-01-01T17:18:14 | 13600 | 0 | 13600 | 12364 | 1236 |
| 3 | 2025-01-01 | 몽핀점 | 84 | 2025-01-01T17:08:16 | 8800 | 0 | 8800 | 8000 | 800 |
| 4 | 2025-01-01 | 몽핀점 | 83 | 2025-01-01T17:07:36 | 5800 | 0 | 5800 | 5273 | 527 |
| 5 | 2025-01-01 | 몽핀점 | 82 | 2025-01-01T16:49:28 | 16300 | 0 | 16300 | 14819 | 1481 |
| 6 | 2025-01-01 | 몽핀점 | 81 | 2025-01-01T16:40:47 | 12300 | 0 | 12300 | 11183 | 1117 |
| 7 | 2025-01-01 | 몽핀점 | 80 | 2025-01-01T16:40:28 | 13600 | 0 | 13600 | 12365 | 1235 |
| 8 | 2025-01-01 | 몽핀점 | 79 | 2025-01-01T16:40:08 | 17000 | 0 | 17000 | 15456 | 1544 |
| 9 | 2025-01-01 | 몽핀점 | 78 | 2025-01-01T16:37:48 | 5500 | 0 | 5500 | 5000 | 500 |
| 10 | 2025-01-01 | 몽핀점 | 77 | 2025-01-01T16:37:08 | 9700 | 0 | 9700 | 8819 | 881 |
| 11 | 2025-01-01 | 몽핀점 | 76 | 2025-01-01T16:33:05 | 16850 | 0 | 16850 | 15319 | 1531 |
| 12 | 2025-01-01 | 몽핀점 | 75 | 2025-01-01T16:30:35 | 39000 | 0 | 39000 | 35456 | 3544 |
| 13 | 2025-01-01 | 몽핀점 | 74 | 2025-01-01T16:29:07 | 21400 | 0 | 21400 | 19456 | 1944 |
| 14 | 2025-01-01 | 몽핀점 | 73 | 2025-01-01T16:28:42 | 14800 | 0 | 14800 | 13456 | 1344 |
| 15 | 2025-01-01 | 몽핀점 | 72 | 2025-01-01T16:15:46 | 5000 | 0 | 5000 | 4546 | 454 |
| 16 | 2025-01-01 | 몽핀점 | 71 | 2025-01-01T16:15:07 | 5000 | 1000 | 4000 | 3637 | 363 |
| 17 | 2025-01-01 | 몽핀점 | 70 | 2025-01-01T16:14:29 | 18400 | 0 | 18400 | 16729 | 1671 |
| 18 | 2025-01-01 | 몽핀점 | 69 | 2025-01-01T16:13:48 | 42000 | 0 | 42000 | 38184 | 3816 |
| 19 | 2025-01-01 | 몽핀점 | 68 | 2025-01-01T16:11:02 | 9100 | 0 | 9100 | 8274 | 826 |
| 20 | 2025-01-01 | 몽핀점 | 67 | 2025-01-01T16:05:00 | 22700 | 0 | 22700 | 20638 | 2062 |

> 참고: 이 테이블은 영수증 단위의 요약 정보를 포함하고 있으며, 한 영수증에 포함된 모든 상품의 합계 금액을 보여줍니다.